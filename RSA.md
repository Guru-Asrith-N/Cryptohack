# RSA 

## Starter

### RSA starter 1

```
a = pow(101,17,22663)
print (a)
```

`flag - 19906 ` 

### RSA starter 2

c = m^e mod N
```
a = pow(12,65537,17*23)
print (a)
```

`flag - 301`

### RSA starter 3

Eulers totient function gives the number of relative primes for the number from 1 to the number itself    
For any prime number p the number of relative primes are p-1   
phi(p*q) = phi(p)*phi(q)  if p and q are primes   

```
p = 857504083339712752489993810777
q = 1029224947942998075080348647219
a = (p-1)*(q-1)
print (a)
```

`flag - 882564595536224140639625987657529300394956519977044270821168 `

### RSA starter 4

d * e == 1 modulo (p-1)(q-1)
d = e ^-1 mod (p-1)*(q-1)
```
p = 857504083339712752489993810777
q = 1029224947942998075080348647219
e = 65537
a = (p-1)*(q-1)
d = pow(e,-1,a)
print (d)
```
`flag - 121832886702415731577073962957377780195510499965398469843281`

### RSA starter 5

d = e ^-1 mod (p-1)*(q-1)   
c = m ^d mod n

```
n = 882564595536224140639625987659416029426239230804614613279163
p = 857504083339712752489993810777
q = 1029224947942998075080348647219
e = 65537
c = 77578995801157823671636298847186723593814843845525223303932

phi = (p-1)*(q-1)
d = pow(e,-1,phi)
m = pow(c,d,n)

print (m)
```
`flag - 13371337`

### RSA starter 6

for signing , first you hash the message which is in bytes    
then convert hash to long integer  
finally you encrypt the number which you get using your private key . the public key can be used to decrypt   
signed_message = (m_hash) ^d mod N
```
import hashlib
from Crypto.Util.number import bytes_to_long

message = b'crypto{Immut4ble_m3ssag1ng}'
m = bytes_to_long(message)
N = 15216583654836731327639981224133918855895948374072384050848479908982286890731769486609085918857664046075375253168955058743185664390273058074450390236774324903305663479046566232967297765731625328029814055635316002591227570271271445226094919864475407884459980489638001092788574811554149774028950310695112688723853763743238753349782508121985338746755237819373178699343135091783992299561827389745132880022259873387524273298850340648779897909381979714026837172003953221052431217940632552930880000919436507245150726543040714721553361063311954285289857582079880295199632757829525723874753306371990452491305564061051059885803
d = 11175901210643014262548222473449533091378848269490518850474399681690547281665059317155831692300453197335735728459259392366823302405685389586883670043744683993709123180805154631088513521456979317628012721881537154107239389466063136007337120599915456659758559300673444689263854921332185562706707573660658164991098457874495054854491474065039621922972671588299315846306069845169959451250821044417886630346229021305410340100401530146135418806544340908355106582089082980533651095594192031411679866134256418292249592135441145384466261279428795408721990564658703903787956958168449841491667690491585550160457893350536334242689

mh = hashlib.sha256(message)

digest =bytes_to_long( mh.digest())

c = pow(digest,d,n)

print (c)
```
`flag -  13480738404590090803339831649238454376183189744970683129909766078877706583282422686710545217275797376709672358894231550335007974983458408620258478729775647818876610072903021235573923300070103666940534047644900475773318682585772698155617451477448441198150710420818995347235921111812068656782998168064960965451719491072569057636701190429760047193261886092862024118487826452766513533860734724124228305158914225250488399673645732882077575252662461860972889771112594906884441454355959482925283992539925713424132009768721389828848907099772040836383856524605008942907083490383109757406940540866978237471686296661685839083475`

## Primes Part 1

### Factoring 

place this number `510143758735509025530880200653196460532653147` in http://factordb.com/   
you will get the factors  
`flag - 19704762736204164635843`

### Inferius Prime

n = 742449129124467073921545687640895127535705902454369756401331   
e = 3    
ct = 39207274348578481322317340648475596807303160111338236677373   
from http://factordb.com/ you can find `p =  752708788837165590355094155871` and `q = 986369682585281993933185289261`      
d =e ^-1 mod phi
pt = ct ^d mod n

```
import hashlib
from Crypto.Util.number import long_to_bytes

n = 742449129124467073921545687640895127535705902454369756401331
e = 3
ct = 39207274348578481322317340648475596807303160111338236677373
p = 752708788837165590355094155871
q = 986369682585281993933185289261
phi = (p-1)*(q-1)

d = pow(e,-1,phi)
pt = pow(ct,d,n)
m = long_to_bytes(pt)

print (m)
```
`flag - crypto{N33d_b1g_pR1m35}`

### Monoprime 

for calculating the private key and public key we use eulers totient of n hence we get `phi = (p-1)*(q-1)`  
but if n were to be prime then the eulers totient would be n-1 because of which it becomes easy to get phi and d   

n = 171731371218065444125482536302245915415603318380280392385291836472299752747934607246477508507827284075763910264995326010251268493630501989810855418416643352631102434317900028697993224868629935657273062472544675693365930943308086634291936846505861203914449338007760990051788980485462592823446469606824421932591      
e = 65537    
ct = 161367550346730604451454756189028938964941280347662098798775466019463375610700074840105776873791605070092554650190486030367121011578171525759600774739890458414593857709994072516290998135846956596662071379067305011746842247628316996977338024343628757374524136260758515864509435302781735938531030576289086798942  

```
import hashlib
from Crypto.Util.number import long_to_bytes

n = 171731371218065444125482536302245915415603318380280392385291836472299752747934607246477508507827284075763910264995326010251268493630501989810855418416643352631102434317900028697993224868629935657273062472544675693365930943308086634291936846505861203914449338007760990051788980485462592823446469606824421932591      
e = 65537    
ct = 161367550346730604451454756189028938964941280347662098798775466019463375610700074840105776873791605070092554650190486030367121011578171525759600774739890458414593857709994072516290998135846956596662071379067305011746842247628316996977338024343628757374524136260758515864509435302781735938531030576289086798942  
phi = n-1
d = pow(e,-1,phi)
pt = pow(ct,d,n)
m = long_to_bytes(pt)

print (m)
```
`flag - crypto{0n3_pr1m3_41n7_pr1m3_l0l}`

### Square eyes 

https://math.stackexchange.com/questions/2912792/calculate-eulers-totient-function-for-perfect-squares   

```
import hashlib
from Crypto.Util.number import long_to_bytes

n = 535860808044009550029177135708168016201451343147313565371014459027743491739422885443084705720731409713775527993719682583669164873806842043288439828071789970694759080842162253955259590552283047728782812946845160334801782088068154453021936721710269050985805054692096738777321796153384024897615594493453068138341203673749514094546000253631902991617197847584519694152122765406982133526594928685232381934742152195861380221224370858128736975959176861651044370378539093990198336298572944512738570839396588590096813217791191895941380464803377602779240663133834952329316862399581950590588006371221334128215409197603236942597674756728212232134056562716399155080108881105952768189193728827484667349378091100068224404684701674782399200373192433062767622841264055426035349769018117299620554803902490432339600566432246795818167460916180647394169157647245603555692735630862148715428791242764799469896924753470539857080767170052783918273180304835318388177089674231640910337743789750979216202573226794240332797892868276309400253925932223895530714169648116569013581643192341931800785254715083294526325980247219218364118877864892068185905587410977152737936310734712276956663192182487672474651103240004173381041237906849437490609652395748868434296753449
e = 65537
ct = 222502885974182429500948389840563415291534726891354573907329512556439632810921927905220486727807436668035929302442754225952786602492250448020341217733646472982286222338860566076161977786095675944552232391481278782019346283900959677167026636830252067048759720251671811058647569724495547940966885025629807079171218371644528053562232396674283745310132242492367274184667845174514466834132589971388067076980563188513333661165819462428837210575342101036356974189393390097403614434491507672459254969638032776897417674577487775755539964915035731988499983726435005007850876000232292458554577437739427313453671492956668188219600633325930981748162455965093222648173134777571527681591366164711307355510889316052064146089646772869610726671696699221157985834325663661400034831442431209123478778078255846830522226390964119818784903330200488705212765569163495571851459355520398928214206285080883954881888668509262455490889283862560453598662919522224935145694435885396500780651530829377030371611921181207362217397805303962112100190783763061909945889717878397740711340114311597934724670601992737526668932871436226135393872881664511222789565256059138002651403875484920711316522536260604255269532161594824301047729082877262812899724246757871448545439896
p = q = 23148667521998097720857168827790771337662483716348435477360567409355026169165934446949809664595523770853897203103759106983985113264049057416908191166720008503275951625738975666019029172377653170602440373579593292576530667773951407647222757756437867216095193174201323278896027294517792607881861855264600525772460745259440301156930943255240915685718552334192230264780355799179037816026330705422484000086542362084006958158550346395941862383925942033730030004606360308379776255436206440529441711859246811586652746028418496020145441513037535475380962562108920699929022900677901988508936509354385660735694568216631382653107
phi = (p-1)*q
d = pow(e,-1,phi)
pt = pow(ct,d,n)
m = long_to_bytes(pt)

print (m)
```
`flag - crypto{squar3_r00t_i5_f4st3r_th4n_f4ct0r1ng!}`

### Many prime

n = 580642391898843192929563856870897799650883152718761762932292482252152591279871421569162037190419036435041797739880389529593674485555792234900969402019055601781662044515999210032698275981631376651117318677368742867687180140048715627160641771118040372573575479330830092989800730105573700557717146251860588802509310534792310748898504394966263819959963273509119791037525504422606634640173277598774814099540555569257179715908642917355365791447508751401889724095964924513196281345665480688029639999472649549163147599540142367575413885729653166517595719991872223011969856259344396899748662101941230745601719730556631637
e = 65537
ct = 320721490534624434149993723527322977960556510750628354856260732098109692581338409999983376131354918370047625150454728718467998870322344980985635149656977787964380651868131740312053755501594999166365821315043312308622388016666802478485476059625888033017198083472976011719998333985531756978678758897472845358167730221506573817798467100023754709109274265835201757369829744113233607359526441007577850111228850004361838028842815813724076511058179239339760639518034583306154826603816927757236549096339501503316601078891287408682099750164720032975016814187899399273719181407940397071512493967454225665490162619270814464     

the factors for n are   
```
 9282105380008121879       9303850685953812323        9389357739583927789        10336650220878499841       10638241655447339831       11282698189561966721       11328768673634243077       11403460639036243901       11473665579512371723       11492065299277279799       11530534813954192171       11665347949879312361       12132158321859677597       12834461276877415051       12955403765595949597       12973972336777979701       13099895578757581201       13572286589428162097       14100640260554622013       14178869592193599187      14278240802299816541       14523070016044624039       14963354250199553339       15364597561881860737      15669758663523555763       15824122791679574573       15998365463074268941       16656402470578844539      16898740504023346457       17138336856793050757       17174065872156629921       17281246625998849649     
```
```
import hashlib
from Crypto.Util.number import long_to_bytes

n = 580642391898843192929563856870897799650883152718761762932292482252152591279>
e = 65537
ct = 32072149053462443414999372352732297796055651075062835485626073209810969258>
phi = ( 9282105380008121879-1)*(9303850685953812323-1)*(9389357739583927789-1)*>
d = pow(e,-1,phi)
pt = pow(ct,d,n)
m = long_to_bytes(pt)

print (m)
```
`flag - crypto{700_m4ny_5m4ll_f4c70r5}`

## Public Exponent 

### Salty 

